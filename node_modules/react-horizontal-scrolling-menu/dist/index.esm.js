import e from"react";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".react-horizontal-scrolling-menu--wrapper {\n  display: flex;\n}\n\n.react-horizontal-scrolling-menu--scroll-container {\n  display: flex;\n  height: max-content;\n  overflow-y: hidden;\n  position: relative;\n  width: 100%;\n}\n\n:export {\n  wrapper: react-horizontal-scrolling-menu--wrapper;\n  container: react-horizontal-scrolling-menu--scroll-container;\n}\n");const t="react-horizontal-scrolling-menu",n=`${t}--separator`,r=`${t}--item`,o=`${t}--scroll-container`,i=`${t}--wrapper`,s="itemId";var l=Object.freeze({__proto__:null,rootClassName:t,separatorString:"-separator",separatorClassName:n,itemClassName:r,scrollContainerClassName:o,wrapperClassName:i,id:s,dataKeyAttribute:"data-key",dataIndexAttribute:"data-index"});function a({className:t="",children:n,onScroll:r=(()=>{}),scrollRef:i}){const s=e.useMemo((()=>`${o} ${t}`),[t]);return e.createElement("div",{className:s,onScroll:r,ref:i},n)}var c=e.memo((function({className:t,id:n,index:r,refs:o}){const i=e.useRef(null);return o[r]=i,e.createElement("div",Object.assign({className:t},{"data-key":n,"data-index":r},{ref:i}))}));var u=e.memo((function({children:t,className:n,id:r,index:o,refs:i}){const s=e.useRef(null);return i[String(o)]=s,e.createElement("div",Object.assign({className:n},{"data-key":r,"data-index":o},{ref:s}),t)}));function d({children:t,itemClassName:o="",refs:i,separatorClassName:l=""}){const a=e.Children.toArray(t).filter(Boolean),d=a.length,m=e.useMemo((()=>`${r} ${o}`),[o]),v=e.useMemo((()=>`${n} ${l}`),[l]);return e.createElement(e.Fragment,null,a.map(((t,n)=>{var r,o;const l=null===(o=null===(r=t)||void 0===r?void 0:r.props)||void 0===o?void 0:o[s],a=l+"-separator",f=n+1===d;return[e.createElement(u,{className:m,id:l,key:"menuItem__"+l,refs:i,index:n},t),!f&&e.createElement(c,{className:v,id:a,refs:i,key:a,index:n+.1})]})))}function m(e,t="smooth",n="end",r="nearest"){var o,i;const s=(null===(i=null===(o=e)||void 0===o?void 0:o.entry)||void 0===i?void 0:i.target)||e;s&&window&&window.requestAnimationFrame((()=>s.scrollIntoView({block:r,behavior:t,inline:n})))}const v=e=>document.querySelector(`[data-key='${e}']`),f=e=>document.querySelector(`[data-index='${e}']`);function h(t){return e.isValidElement(t)&&t||"function"==typeof t&&e.createElement(t,null)||null}const p=e=>e.filter((e=>!new RegExp(".*-separator$").test(e)));function g({items:t,itemsChanged:n,refs:r,options:o}){const i=e.useRef(),[s,l]=e.useState([]),a=e.useRef(+setTimeout((()=>{}),0)),c=e.useCallback((e=>{t.set(function(e,t){return[...e].map((e=>{var n,r;const o=e.target,i=(null===(n=null==o?void 0:o.dataset)||void 0===n?void 0:n.key)||"";return[i,{index:String((null===(r=null==o?void 0:o.dataset)||void 0===r?void 0:r.index)||""),key:i,entry:e,visible:e.intersectionRatio>=t.ratio}]}))}(e,o)),global.clearTimeout(a.current),a.current=+setTimeout((()=>global.requestAnimationFrame((()=>{l((e=>{const n=t.getVisible().map((e=>e[1].key));return JSON.stringify(e)!==JSON.stringify(n)?n:e}))}))),o.throttle)}),[t,o]);return e.useLayoutEffect((()=>{const e=(e=>Object.values(e).map((e=>e.current)).filter(Boolean))(r),t=i.current||new IntersectionObserver(c,o);return i.current=t,e.forEach((e=>t.observe(e))),()=>{clearTimeout(a.current),t.disconnect(),i.current=void 0}}),[c,n,o,r]),{visibleItems:s}}function b(t,n){const[r,o]=e.useState(""),i=e.useMemo((()=>{return n=t,e.Children.toArray(n).map((e=>{var t,n;return null===(n=null===(t=e)||void 0===t?void 0:t.props)||void 0===n?void 0:n[s]})).filter(Boolean);var n}),[t]);return e.useEffect((()=>{o(i.filter(Boolean).join(""))}),[i]),e.useEffect((()=>{n.toItemsWithoutSeparators().filter((e=>!i.includes(e))).forEach((e=>n.delete(e)))}),[r]),r}class x extends Map{toArr(){return this.sort([...this])}toItems(){return this.toArr().map((([e])=>e))}toItemsWithoutSeparators(){return p(this.toItems())}toItemsKeys(){return this.toItems()}sort(e){return e.sort((([,e],[,t])=>+e.index-+t.index))}set(e,t){return Array.isArray(e)?this.sort(e).forEach((([e,t])=>{super.set(e,t)})):super.set(e,t),this}first(){var e;return null===(e=this.toArr()[0])||void 0===e?void 0:e[1]}last(){var e,t;return null===(t=null===(e=this.toArr().slice(-1))||void 0===e?void 0:e[0])||void 0===t?void 0:t[1]}filter(e){return this.toArr().filter(e)}find(e){return this.toArr().find(e)}findIndex(e){return this.toArr().findIndex(e)}prev(e){var t;const n=this.toArr(),r=n.findIndex((([t,n])=>t===e||n===e));return-1!==r?null===(t=n[r-1])||void 0===t?void 0:t[1]:void 0}next(e){var t;const n=this.toArr(),r=n.findIndex((([t,n])=>t===e||n===e));return-1!==r?null===(t=n[r+1])||void 0===t?void 0:t[1]:void 0}getVisible(){return this.filter((e=>e[1].visible))}}const I={ratio:.9,rootMargin:"5px",threshold:[.05,.5,.75,.95],throttle:100};function y({cb:t=(()=>{}),condition:n,visibleItems:r}){const o=n?JSON.stringify(r):"",i=function(t){const n=e.useRef();return e.useEffect((()=>{n.current=t}),[t]),n.current}(o);e.useEffect((()=>{n&&i!==o&&t()}),[n,i,o])}const N=e.createContext({}),C=e=>e.reduce(((e,t)=>e.concat(t).concat(`${t}-separator`)),[]).slice(0,-1);function E(e,t){const n=p(e),r=p(t);return{prev:()=>C(function(e,t){const n=e.findIndex((e=>e===(null==t?void 0:t[0]))),r=t.length,o=n-r,i=o<0,s=i?0:o,l=e.slice(s,i?r:n);return l.length===r?l:e.slice(n,r)}(n,r)),next:()=>C(function(e,t){const n=e.findIndex((e=>{var n;return e===(null===(n=t.slice(-1))||void 0===n?void 0:n[0])})),r=t.length,o=n+r+1,i=o>e.length-1,s=i?e.length-1:o,l=e.slice(i?s-r+1:n+1,s);return l.length===r?l:e.slice(e.length-r,e.length+r)}(n,r))}}const S=e=>{var t;const n=(e=>e.filter(((e,t,n)=>{const r=0===t,o=t===n.length-1,i=new RegExp("-separator").test(e);return!((r||o)&&i)})))(e),r=n[Math.floor(n.length/2)];return{first:null==n?void 0:n[0],center:r,last:null===(t=n.slice(-1))||void 0===t?void 0:t[0]}};function w({LeftArrow:t,RightArrow:n,children:r,onInit:o=(()=>{}),onUpdate:s=(()=>{}),onMouseDown:l,onMouseUp:c,onMouseMove:u,onScroll:C=(()=>{}),onWheel:E=(()=>{}),options:S=I,scrollContainerClassName:w="",itemClassName:A="",separatorClassName:M="",wrapperClassName:$="",apiRef:R={current:{}}}){const k=h(t),O=h(n),j=e.useRef(null),[B]=e.useState({}),V=e.useMemo((()=>Object.assign(Object.assign(Object.assign({},I),S),{root:j.current})),[S,j.current]),T=e.useRef(new x).current,z=b(r,T),{visibleItems:_}=g({items:T,itemsChanged:z,options:V,refs:B}),W=e.useRef({}),q=!!_.length;y({cb:()=>s(W.current),condition:function({cb:t,condition:n}){let r=n;null!=r||(r=!0);const[o,i]=e.useState(!1);return e.useEffect((()=>{r&&!o&&(i(!0),t())}),[r,o]),o}({cb:()=>o(W.current),condition:q}),visibleItems:_});const F=e.useMemo((()=>function(e,t=[]){var n,r;const o=p(t),i=!!(null===(n=e.first())||void 0===n?void 0:n.visible),s=!!(null===(r=e.last())||void 0===r?void 0:r.visible),l=t=>{var n;return null===(n=e.find((e=>e[1].key===String(t))))||void 0===n?void 0:n[1]},a=()=>{var t,n;return e.prev(null===(n=null===(t=e.getVisible())||void 0===t?void 0:t[0])||void 0===n?void 0:n[1])},c=()=>{var t,n,r,o;return e.next(null===(o=null===(r=null===(n=null===(t=e.getVisible())||void 0===t?void 0:t.slice)||void 0===n?void 0:n.call(t,-1))||void 0===r?void 0:r[0])||void 0===o?void 0:o[1])};return{getItemById:l,getItemElementById:v,getItemByIndex:t=>{var n;return null===(n=e.find((e=>String(e[1].index)===String(t))))||void 0===n?void 0:n[1]},getItemElementByIndex:f,getNextItem:c,getPrevItem:a,isFirstItemVisible:i,isItemVisible:e=>t.includes(e),isLastItem:t=>e.last()===l(t),isLastItemVisible:s,scrollNext:(e="smooth",t="start",n="nearest")=>m(c(),e,t,n),scrollPrev:(e="smooth",t="end",n="nearest")=>m(a(),e,t,n),scrollToItem:m,visibleItems:t,visibleItemsWithoutSeparators:o}}(T,_)),[T,_]);W.current=e.useMemo((()=>Object.assign(Object.assign({},F),{initComplete:q,items:T,scrollContainer:j})),[F,q,T]),R.current=W.current;const L=e.useCallback((e=>C(W.current,e)),[C,W]),J=e.useCallback((e=>E(W.current,e)),[E,W]),P=e.useMemo((()=>`${i} ${$}`),[$]);return e.createElement("div",{className:P,onWheel:J,onMouseDown:null==l?void 0:l(W.current),onMouseUp:null==c?void 0:c(W.current),onMouseMove:null==u?void 0:u(W.current)},e.createElement(N.Provider,{value:W.current},k,e.createElement(a,{className:w,onScroll:L,scrollRef:j},e.createElement(d,{refs:B,itemClassName:A,separatorClassName:M},r)),O))}export{w as ScrollMenu,N as VisibilityContext,l as constants,S as getItemsPos,E as slidingWindow};
